{% extends "../base_panel.html" %}
{% block title %}لیست سفارشات{% endblock %}
{% load static %}
{% block dashboard_content %}

<div class="col-xl-9">
    <div class="section-title-title">
        <h2 class="fw-900 h4">آخرین<span class="with-highlight ms-1">سفارشات</span>
        </h2>
        <div class="Dottedsquare"></div>
    </div>
    <div class="content">
        <div class="alert slider-parent bg-white mt-3 shadow-box rounded-4">
            <div class="tab-product-nav tab-panel-tbl  p-3 rounded-3">
                <ul class="nav nav-tabs border-0" id="myTab" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link btn border-bottom-0 active" id="latest-order"
                                data-bs-toggle="tab" data-bs-target="#latest-order-pane" type="button"
                                role="tab" aria-controls="latest-order-pane" aria-selected="true">آخرین
                            سفارشات</button>
                    </li>
                </ul>
            </div>
            <div class="tab-content tab-product-content" id="myTabContent">
                <div class="tab-pane fade active show" id="latest-order-pane" role="tabpanel"
                     aria-labelledby="latest-order" tabindex="0">
                    <div class="panel-latest-order">
                        {% if orders %}
                        <div class="table-responsive roundedTable p-0">
                            <table class="table table-bordered main-table rounded-0">
                                <tbody>
                                {% for order in orders %}
                                <tr>
                                    <td colspan="2" class="align-middle">
                                        <div class="avatar-group d-flex align-items-center justify-content-center assigned-avatar">
                                            {% for item in order.items %}
                                            <div class="avatar avatar-md" data-bs-toggle="tooltip"
                                                 data-bs-placement="top"
                                                 aria-label="{{ item.product_name }}"
                                                 data-bs-original-title="{{ item.product_name }}">
                                                <a href="{% url 'product_detail' product_id=item.product %}">
                                                    <img src="{{ item.product_image }}"
                                                         alt="{{ item.product_name }}" class="rounded-circle pull-up">
                                                </a>
                                            </div>
                                            {% endfor %}
                                        </div>
                                    </td>
                                    <td colspan="2" class="align-middle">
                                        <h5 class="text-overflow-1 mt-2 font-15">
                                            سفارش شماره {{ order.id }}  
                                        </h5>
                                    </td>
                                    <td colspan="2" class="align-middle">
                                        <div class="d-flex align-items-center">
                                            <p class="mb-0 text-muted font-15">کد سفارش</p>
                                            <p class="mb-0 ms-2 font-12 fw-bold">{{ order.id }}</p>
                                        </div>
                                        <p class="mb-0 text-muted mt-2 font-14">{{ order.created_at_formatted }}</p>
                                    </td>
                                    <td colspan="2" class="align-middle">
                                        <div class="d-flex align-items-center">
                                            <p class="mb-0 text-muted font-15">مبلغ</p>
                                            <p class="mb-0 ms-2 fw-bold font-14">{{ order.total_price}} تومان</p>
                                        </div>
                                        <p class="mb-0 fw-bold mt-2 font-14">
                                            <i class="bi bi-check-circle-fill me-1 main-color-three-color"></i>
                                            {% if order.status == 'registered' %}
                                                ثبت‌شده
                                            {% elif order.status == 'confirmed' %}
                                                پراخت شده
                                            {% elif order.status == 'shipped' %}
                                                ارسال‌شده
                                            {% elif order.status == 'completed' %}
                                                تکمیل‌شده
                                            {% elif order.status == 'canceled' %}
                                                لغو‌شده
                                            {% else %}
                                                وضعیت نامشخص
                                            {% endif %}
                                        </p>
                                    </td>
                                    <td colspan="2" class="align-middle">
                                        <div class="text-center">
                                            <a href="" class="btn main-color-one-bg">مشاهده</a>
                                        </div>
                                    </td>
                                </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                        </div>
                        {% else %}
                        <div class="order-list__table-body" id="js-orders-table-body">
                            <div class="order-list--empty">
                                <svg xmlns="http://www.w3.org/2000/svg" width="150" height="150"
                                     viewBox="0 0 150 150" fill="none">
                                    <path d="M14.8323 44.1052L93.1651 29.6021L106.815 103.327L28.4823 117.83L14.8323 44.1052Z"
                                          fill="#B3B9BF"></path>
                                    <path d="M29.8665 22.2656L14.843 44.1164L44.8008 38.5688L93.1969 29.6086L108.22 7.75781L29.8665 22.2656Z"
                                          fill="#C0C2C9"></path>
                                    <path d="M108.22 7.75781L93.1965 29.6086L106.851 103.355L121.875 81.5039L108.22 7.75781Z"
                                          fill="#A6ABB3"></path>
                                    <path d="M44.7856 38.5598L63.2169 35.1473L68.7622 65.0981L50.331 68.5106L44.7856 38.5598Z"
                                          fill="#9BA1A8"></path>
                                    <path d="M63.2391 35.1539L44.8008 38.5687L59.8242 16.7179L78.2625 13.3054L63.2391 35.1539Z"
                                          fill="#9BA1A8"></path>
                                    <path d="M21.0938 21.0938H16.4062C16.4062 12.0492 23.7656 4.6875 32.8125 4.6875H35.1562V9.375H32.8125C26.3508 9.375 21.0938 14.632 21.0938 21.0938Z"
                                          fill="#9BA1A8"></path>
                                    <path d="M111.875 135.312H109.531V130.625H111.875C118.337 130.625 123.594 125.368 123.594 118.906H128.281C128.281 127.951 120.922 135.312 111.875 135.312Z"
                                          fill="#9BA1A8"></path>
                                    <path d="M104.844 128.281H102.5V123.594H104.844C111.305 123.594 116.562 118.337 116.562 111.875H121.25C121.25 120.92 113.891 128.281 104.844 128.281Z"
                                          fill="#9BA1A8"></path>
                                </svg>
                                <p class="order-list__empty-text">سفارشی موجود نیست!</p></div>
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
<div class="container">
    <h1 class="my-4">سفارشات من</h1>
    
    {% if error %}
        <div class="alert alert-danger">
            {{ error }}
            {% if status_code %}
                <p>کد وضعیت: {{ status_code }}</p>
            {% endif %}
        </div>
    {% else %}
        {% if orders %}
            <div class="table-responsive">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>شناسه سفارش</th>
                            <th>مبلغ کل</th>
                            <th>وضعیت</th>
                            <th>تاریخ ایجاد</th>
                            <th>عملیات</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for order in orders %}
                        <tr>
                            <td>{{ order.id }}</td>
                            <td>{{ order.total_price }} تومان</td>
                            <td>{{ order.status }}</td>
                            <td>{{ order.created_at }}</td>
                            <td>
                                <a href="" class="btn btn-primary btn-sm">جزئیات</a>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        {% else %}
            <p class="alert alert-info">سفارشی یافت نشد.</p>
        {% endif %}
    {% endif %}
</div>